‚úÖ ngspice found
[2026-01-27 12:01:54] ======================================================================
[2026-01-27 12:01:54] üöÄ SPICE-IN-THE-LOOP PRODUCTION TRAINING
[2026-01-27 12:01:54] ======================================================================
[2026-01-27 12:01:54] Device: cpu
[2026-01-27 12:01:54] SPICE workers: 4
[2026-01-27 12:01:54] Surrogate epochs: 1000
[2026-01-27 12:01:54] RL iterations (with real SPICE): 2000
[2026-01-27 12:01:54] 
[2026-01-27 12:01:54] üì¶ Loading SPICE-validated data...
[2026-01-27 12:01:54]    Samples: 35,000
[2026-01-27 12:01:54] 
======================================================================
[2026-01-27 12:01:54] üß† PHASE 1: TRAINING SURROGATE MODEL
[2026-01-27 12:01:54] ======================================================================
[2026-01-27 12:01:54]    Parameters: 1,157,731
[2026-01-27 12:01:58]    Epoch    1/1000: train=1367.6804, val=851.9378, patience=0/50, ETA=0:55:19
[2026-01-27 12:04:28]    Epoch   50/1000: train=13.5383, val=8.0083, patience=1/50, ETA=0:48:39
[2026-01-27 12:07:17]    Epoch  100/1000: train=9.2694, val=5.5854, patience=9/50, ETA=0:48:27
[2026-01-27 12:10:20]    Epoch  150/1000: train=7.8056, val=4.8262, patience=13/50, ETA=0:47:46
[2026-01-27 12:13:26]    Epoch  200/1000: train=6.7090, val=4.7645, patience=4/50, ETA=0:46:06
[2026-01-27 12:16:36]    Epoch  250/1000: train=5.2423, val=3.3895, patience=11/50, ETA=0:44:05
[2026-01-27 12:19:43]    Epoch  300/1000: train=4.5570, val=2.9992, patience=3/50, ETA=0:41:33
[2026-01-27 12:22:53]    Epoch  350/1000: train=4.2070, val=2.5281, patience=3/50, ETA=0:38:56
[2026-01-27 12:25:59]    Epoch  400/1000: train=4.1305, val=2.4462, patience=6/50, ETA=0:36:07
[2026-01-27 12:29:11]    Epoch  450/1000: train=4.0344, val=2.3706, patience=14/50, ETA=0:33:20
[2026-01-27 12:31:17]    ‚èπÔ∏è Early stopping at epoch 486
[2026-01-27 12:31:17]    ‚úÖ Best val loss: 2.316986
Traceback (most recent call last):
  File "/Users/tushardhananjaypathak/Desktop/MLEntry/train_spice_loop.py", line 574, in <module>
    checkpoint = torch.load(BASE_PATH / 'checkpoints' / 'multi_topology_surrogate.pt')
  File "/opt/homebrew/Caskroom/miniconda/base/lib/python3.13/site-packages/torch/serialization.py", line 1548, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
